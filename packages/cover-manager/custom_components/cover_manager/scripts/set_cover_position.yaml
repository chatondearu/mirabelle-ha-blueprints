alias: "Set Cover Position"
description: "Set a cover to a specific position using a switch"
fields:
  cover_switch:
    name: Cover Switch
    description: "Switch entity that controls the cover"
    required: true
    selector:
      entity:
        domain: switch
  position:
    name: Position
    description: "Position to set the cover to (0-100)"
    required: true
    selector:
      number:
        min: 0
        max: 100
        step: 1
        unit_of_measurement: "%"
  travel_time:
    name: Travel Time
    description: "Time in seconds to fully open/close the cover"
    required: true
    selector:
      number:
        min: 1
        max: 300
        step: 1
        unit_of_measurement: s
  last_state:
    name: Last State
    description: "Input text entity to store the last state of the cover"
    required: true
    selector:
      entity:
        domain: input_text

sequence:
  # Update position helper
  - service: input_text.set_value
    data:
      entity_id: !input last_state
      value: !input position

  # Start movement
  - service: switch.turn_on
    target:
      entity_id: !input cover_switch

  # Wait for calculated time
  - delay:
      seconds: !input travel_time

  # Stop movement
  - service: switch.turn_off
    target:
      entity_id: !input cover_switch 